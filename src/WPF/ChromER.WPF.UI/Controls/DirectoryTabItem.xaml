<UserControl x:Class="ChromER.WPF.UI.DirectoryTabItem"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:ui="clr-namespace:ChromER.WPF.UI"
             xmlns:chromEr="clr-namespace:ChromER;assembly=ChromER"
             xmlns:squircle="clr-namespace:Squircle;assembly=Squircle"
             mc:Ignorable="d"

             d:DesignHeight="450" d:DesignWidth="800">
    <UserControl.Resources>
        <Style TargetType="{x:Type RadioButton}">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderBrush" Value="Transparent" />
            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="4" />
            <Setter Property="Margin" Value="2" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type RadioButton}">
                        <squircle:Squircle x:Name="templateRoot"
                                           Background="{TemplateBinding Background}"
                                           SnapsToDevicePixels="True">

                            <ContentPresenter x:Name="contentPresenter"
                                              Focusable="False"
                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                              Margin="{TemplateBinding Padding}" RecognizesAccessKey="True"
                                              SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                        </squircle:Squircle>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="LightSkyBlue" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true" />
                            <Trigger Property="IsChecked" Value="true">
                                <Setter Property="Background" Value="DeepSkyBlue" />
                            </Trigger>
                            <Trigger Property="IsChecked" Value="{x:Null}" />
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <UserControl.InputBindings>
        <ui:ExtendedMouseBinding Gesture="XButton1"
                                 Command="{Binding MoveBackCommand}" />
        <ui:ExtendedMouseBinding Gesture="XButton2"
                                 Command="{Binding MoveForwardCommand}" />

        <KeyBinding Modifiers="Alt" Key="Left"
                    Command="{Binding MoveBackCommand}" />
        <KeyBinding Modifiers="Alt" Key="Right"
                    Command="{Binding MoveForwardCommand}" />
    </UserControl.InputBindings>

    <Grid Background="{DynamicResource ToolBarBackground}">

        <Grid.RowDefinitions>

            <!--Search TextBox-->
            <RowDefinition Height="36" />

            <!-- BookMarks-->
            <RowDefinition Height="36" />

            <RowDefinition Height="*" />

        </Grid.RowDefinitions>

        <!--Search TextBox-->
        <Grid Grid.Row="0"
              Margin="5 0">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <Grid.Resources>
                <Style TargetType="{x:Type Button}">
                    <Setter Property="Background" Value="Transparent" />
                    <Setter Property="BorderBrush" Value="Transparent" />
                    <Setter Property="Foreground" Value="White" />
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Margin" Value="2" />
                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />

                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="{x:Type Button}">
                                <Border x:Name="border"
                                        Height="28"
                                        Width="28"
                                        CornerRadius="14"
                                        Background="{TemplateBinding Background}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        SnapsToDevicePixels="true">

                                    <Viewbox Width="22"
                                             Height="22"
                                             Stretch="Uniform">
                                        <ContentPresenter />
                                    </Viewbox>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="true">
                                        <Setter Property="Background" Value="#454545" />
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="true">
                                        <Setter Property="Background" Value="#333333" />
                                    </Trigger>
                                    <Trigger Property="IsEnabled" Value="false">
                                        <Setter Property="Foreground" Value="#8C8C8C" />
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Grid.Resources>

            <Button ToolTip="Нажмите, чтобы вернуться."
                    Command="{Binding MoveBackCommand}">
                <Canvas Width="24" Height="24">
                    <Path
                        Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Button}}"
                        Data="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" />
                </Canvas>
            </Button>

            <Button Grid.Column="1"
                    ToolTip="Нажмите, чтобы перейти вперёд."
                    Command="{Binding MoveForwardCommand}">
                <Canvas Width="24" Height="24">
                    <Path
                        Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Button}}"
                        Data="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" />
                </Canvas>
            </Button>

            <Button Grid.Column="2"
                    ToolTip="Обновить">
                <Canvas Width="24" Height="24">
                    <Path
                        Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Button}}"
                        Data="M21,10.12H14.22L16.96,7.3C14.23,4.6 9.81,4.5 7.08,7.2C4.35,9.91 4.35,14.28 7.08,17C9.81,19.7 14.23,19.7 16.96,17C18.32,15.65 19,14.08 19,12.1H21C21,14.08 20.12,16.65 18.36,18.39C14.85,21.87 9.15,21.87 5.64,18.39C2.14,14.92 2.11,9.28 5.62,5.81C9.13,2.34 14.76,2.34 18.27,5.81L21,3V10.12M12.5,8V12.25L16,14.33L15.28,15.54L11,13V8H12.5Z" />
                </Canvas>
            </Button>

            <ui:SearchControl Grid.Column="3"
                              VerticalAlignment="Center"
                              Margin="10 0"
                              Text="{Binding SearchText}">
                <ui:SearchControl.Resources>
                    <Style TargetType="{x:Type Button}">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="BorderBrush" Value="Transparent" />
                        <Setter Property="Foreground" Value="White" />
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="Margin" Value="2 2 4 2" />
                        <Setter Property="HorizontalContentAlignment" Value="Center" />
                        <Setter Property="VerticalContentAlignment" Value="Center" />

                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="{x:Type Button}">
                                    <Border x:Name="border"
                                            Height="24"
                                            Width="24"
                                            CornerRadius="14"
                                            Background="{TemplateBinding Background}"
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            SnapsToDevicePixels="true">

                                        <Viewbox Width="18"
                                                 Height="18"
                                                 Stretch="Uniform">
                                            <ContentPresenter />
                                        </Viewbox>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="true">
                                            <Setter Property="Background" Value="#454545" />
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="true">
                                            <Setter Property="Background" Value="#333333" />
                                        </Trigger>
                                        <Trigger Property="IsEnabled" Value="false">
                                            <Setter Property="Foreground" Value="#8C8C8C" />
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </ui:SearchControl.Resources>
                <ui:SearchControl.ButtonsContent>
                    <StackPanel Orientation="Horizontal">
                        <Button Command="{Binding AddBookmarkCommand}"
                                CommandParameter="{Binding FilePath}">
                            <Path Stretch="Uniform"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Button}}"
                                  Data="M5.8 21L7.4 14L2 9.2L9.2 8.6L12 2L14.8 8.6L22 9.2L18.8 12H18C17.3 12 16.6 12.1 15.9 12.4L18.1 10.5L13.7 10.1L12 6.1L10.3 10.1L5.9 10.5L9.2 13.4L8.2 17.7L12 15.4L12.5 15.7C12.3 16.2 12.1 16.8 12.1 17.3L5.8 21M17 14V17H14V19H17V22H19V19H22V17H19V14H17Z" />

                        </Button>
                    </StackPanel>
                </ui:SearchControl.ButtonsContent>
            </ui:SearchControl>
        </Grid>

        <!-- BookMarks-->
        <Grid Grid.Row="1">
            <Menu Background="Transparent"
                  VerticalAlignment="Center"
                  ItemsSource="{Binding DataContext.Bookmarks, RelativeSource={RelativeSource AncestorType={x:Type Window}}}">
                <Menu.Resources>
                    <Style TargetType="{x:Type MenuItem}">
                        <Setter Property="Header"
                                Value="{Binding DataContext.Header, RelativeSource={RelativeSource Self}}" />
                        <Setter Property="ItemsSource"
                                Value="{Binding DataContext.Items, RelativeSource={RelativeSource Self}}" />
                        <Setter Property="Command"
                                Value="{Binding DataContext.Command, RelativeSource={RelativeSource Self}}" />
                        <Setter Property="CommandParameter">
                            <Setter.Value>
                                <MultiBinding Converter="{ui:CloneParamsConverter}">
                                    <Binding Path="DataContext.CommandParameter"
                                             RelativeSource="{RelativeSource Self}" />
                                    <Binding Path="DataContext"
                                             RelativeSource="{RelativeSource AncestorType={x:Type ui:DirectoryTabItem}}" />
                                </MultiBinding>
                            </Setter.Value>
                        </Setter>

                        <Setter Property="Icon"
                                Value="{Binding DataContext.IconPath, Converter={ui:IconPathToImageConverter}, RelativeSource={RelativeSource Self}}" />
                    </Style>
                    <HierarchicalDataTemplate
                        DataType="{x:Type chromEr:MenuItemViewModel}"
                        ItemsSource="{Binding Path=Bookmarks}" />
                </Menu.Resources>
            </Menu>
        </Grid>

        <Grid Grid.Row="2">
            <ContentControl x:Name="ContentControl"
                            Content="{Binding FilesPresenter}">
                <ContentControl.ContextMenu>
                    <ContextMenu>

                        <MenuItem Header="Назад"
                                  InputGestureText="Alt + Стрелка влево"
                                  Command="{Binding MoveBackCommand}" />

                        <MenuItem Header="Вперёд"
                                  InputGestureText="Alt + Стрелка вправо"
                                  Command="{Binding MoveForwardCommand}" />

                        <MenuItem Header="Обновить" InputGestureText="Ctrl + R" />

                        <Separator />

                        <MenuItem Header="Вид">
                            <MenuItem Header="Значки"
                                      IsCheckable="True"
                                      IsChecked="{Binding IsTilePresenter, Mode=TwoWay}" />
                            <MenuItem Header="Таблица"
                                      IsCheckable="True"
                                      IsChecked="{Binding IsGridPresenter, Mode=TwoWay}" />
                        </MenuItem>
                        <MenuItem Header="Сортировка" />
                        <MenuItem Header="Группировка" />

                        <Separator />

                        <MenuItem Header="Свойства" />
                    </ContextMenu>
                </ContentControl.ContextMenu>
                <ContentControl.Resources>
                    <DataTemplate DataType="{x:Type chromEr:TileFilesPresenterViewModel}">
                        <ui:TileFilePresenter />
                    </DataTemplate>
                    <DataTemplate DataType="{x:Type chromEr:GridFilesPresenterViewModel}">
                        <ui:GridFilesPresenter />
                    </DataTemplate>
                </ContentControl.Resources>
            </ContentControl>

            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Bottom"
                        Margin="20">

                <RadioButton GroupName="PresenterView"
                             IsChecked="{Binding IsTilePresenter, Mode=TwoWay}">
                    <Image Width="26"
                           Height="26"
                           Stretch="Uniform">
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V480 H480 V0 H0 Z">
                                        <GeometryDrawing Brush="#FFFF9478"
                                                         Geometry="F1 M480,480z M0,0z M296,8L440,8C457.671875,8,472,22.328125,472,40L472,184C472,201.671875,457.671875,216,440,216L296,216C278.328125,216,264,201.671875,264,184L264,40C264,22.328125,278.328125,8,296,8z M296,8" />
                                        <GeometryDrawing Brush="#FF78B9EB"
                                                         Geometry="F1 M480,480z M0,0z M40,8L184,8C201.671875,8,216,22.328125,216,40L216,184C216,201.671875,201.671875,216,184,216L40,216C22.328125,216,8,201.671875,8,184L8,40C8,22.328125,22.328125,8,40,8z M40,8" />
                                        <GeometryDrawing Brush="#FFFFE477"
                                                         Geometry="F1 M480,480z M0,0z M296,264L440,264C457.671875,264,472,278.328125,472,296L472,440C472,457.671875,457.671875,472,440,472L296,472C278.328125,472,264,457.671875,264,440L264,296C264,278.328125,278.328125,264,296,264z M296,264" />
                                        <GeometryDrawing Brush="#FFFFC477"
                                                         Geometry="F1 M480,480z M0,0z M40,264L184,264C201.671875,264,216,278.328125,216,296L216,440C216,457.671875,201.671875,472,184,472L40,472C22.328125,472,8,457.671875,8,440L8,296C8,278.328125,22.328125,264,40,264z M40,264" />
                                        <DrawingGroup Opacity="1">
                                            <GeometryDrawing Brush="#FF3E3D42"
                                                             Geometry="F1 M480,480z M0,0z M80,224C83.25,224.019531 86.1875,222.070312 87.433594,219.066406 88.679688,216.066406 87.988281,212.609375 85.679688,210.320312 83.378906,208.050781 79.9375,207.386719 76.960938,208.640625 75.980469,209.027344 75.085938,209.597656 74.320312,210.320312 71.226562,213.476562 71.226562,218.523438 74.320312,221.679688 75.085938,222.402344 75.980469,222.972656 76.960938,223.359375 77.921875,223.769531 78.953125,223.988281 80,224z M80,224" />
                                            <GeometryDrawing Brush="#FF3E3D42"
                                                             Geometry="F1 M480,480z M0,0z M184,0L40,0C17.917969,0.0273438,0.027343799999997,17.917969,0,40L0,184C0.0273438,206.082031,17.917969,223.972656,40,224L56,224C60.417969,224 64,220.417969 64,216 64,211.582031 60.417969,208 56,208L40,208C26.746094,208,16,197.253906,16,184L16,40C16,26.746094,26.746094,16,40,16L184,16C197.253906,16,208,26.746094,208,40L208,184C208,197.253906,197.253906,208,184,208L104,208C99.582031,208 96,211.582031 96,216 96,220.417969 99.582031,224 104,224L184,224C206.082031,223.972656,223.972656,206.082031,224,184L224,40C223.972656,17.917969,206.082031,0.027343799999997,184,0z M184,0" />
                                            <GeometryDrawing Brush="#FF3E3D42"
                                                             Geometry="F1 M480,480z M0,0z M440,0L296,0C273.917969,0.0273438,256.027344,17.917969,256,40L256,184C256.027344,206.082031,273.917969,223.972656,296,224L440,224C462.082031,223.972656,479.972656,206.082031,480,184L480,40C479.972656,17.917969,462.082031,0.027343799999997,440,0z M464,184C464,197.253906,453.253906,208,440,208L296,208C282.746094,208,272,197.253906,272,184L272,40C272,26.746094,282.746094,16,296,16L440,16C453.253906,16,464,26.746094,464,40z M464,184" />
                                            <GeometryDrawing Brush="#FF3E3D42"
                                                             Geometry="F1 M480,480z M0,0z M440,256L296,256C273.917969,256.027344,256.027344,273.917969,256,296L256,440C256.027344,462.082031,273.917969,479.972656,296,480L440,480C462.082031,479.972656,479.972656,462.082031,480,440L480,296C479.972656,273.917969,462.082031,256.027344,440,256z M464,440C464,453.253906,453.253906,464,440,464L296,464C282.746094,464,272,453.253906,272,440L272,296C272,282.746094,282.746094,272,296,272L440,272C453.253906,272,464,282.746094,464,296z M464,440" />
                                            <GeometryDrawing Brush="#FF3E3D42"
                                                             Geometry="F1 M480,480z M0,0z M184,256L40,256C17.917969,256.027344,0.027343799999997,273.917969,0,296L0,440C0.0273438,462.082031,17.917969,479.972656,40,480L184,480C206.082031,479.972656,223.972656,462.082031,224,440L224,296C223.972656,273.917969,206.082031,256.027344,184,256z M208,440C208,453.253906,197.253906,464,184,464L40,464C26.746094,464,16,453.253906,16,440L16,296C16,282.746094,26.746094,272,40,272L184,272C197.253906,272,208,282.746094,208,296z M208,440" />
                                        </DrawingGroup>
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>

                </RadioButton>
                <RadioButton GroupName="PresenterView"
                             IsChecked="{Binding IsGridPresenter, Mode=TwoWay}">
                    <Image Width="26"
                           Height="26"
                           Stretch="Uniform">
                        <Image.Source>
                            <DrawingImage>
                                <DrawingImage.Drawing>
                                    <DrawingGroup ClipGeometry="M0,0 V128 H128 V0 H0 Z">
                                        <GeometryDrawing Brush="#FFE6E7E8">
                                            <GeometryDrawing.Geometry>
                                                <RectangleGeometry RadiusX="1" RadiusY="1"
                                                                   Rect="8.165,19.667,115.67,92.666" />
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                        <GeometryDrawing Brush="#FFD4FBFF">
                                            <GeometryDrawing.Geometry>
                                                <RectangleGeometry RadiusX="0" RadiusY="0"
                                                                   Rect="5.165,16.667,113.67,90.667" />
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                        <GeometryDrawing Brush="#FF0089EF">
                                            <GeometryDrawing.Geometry>
                                                <RectangleGeometry RadiusX="0" RadiusY="0"
                                                                   Rect="5.165,16.667,28.417,90.667" />
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                        <GeometryDrawing Brush="#FFFA759E">
                                            <GeometryDrawing.Geometry>
                                                <RectangleGeometry RadiusX="0" RadiusY="0"
                                                                   Rect="5.165,16.667,113.67,15.111" />
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                        <GeometryDrawing Brush="#FFFFFFFF">
                                            <GeometryDrawing.Geometry>
                                                <RectangleGeometry RadiusX="0" RadiusY="0" Rect="5.165,16.667,113.67,3" />
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                        <GeometryDrawing Brush="#FF3A2C60"
                                                         Geometry="F1 M128,128z M0,0z M118.835,15.667L5.165,15.667A1,1,0,0,0,4.165,16.667L4.165,50.5A1,1,0,0,0,6.165,50.5L6.165,47.889 32.582,47.889 32.582,61 6.165,61 6.165,54A1,1,0,0,0,4.165,54L4.165,65A1,1,0,0,0,6.165,65L6.165,63 32.582,63 32.582,76.111 6.165,76.111 6.165,68.834A1,1,0,0,0,4.165,68.834L4.165,107.334A1,1,0,0,0,5.165,108.334L118.835,108.334A1,1,0,0,0,119.835,107.334L119.835,16.667A1,1,0,0,0,118.835,15.667z M61,93.223L61,106.334 34.582,106.334 34.582,93.223z M34.582,91.223L34.582,78.111 61,78.111 61,91.223z M63,93.223L89.418,93.223 89.418,106.334 63,106.334z M63,91.223L63,78.111 89.418,78.111 89.418,91.223z M61,30.778L34.582,30.778 34.582,17.667 61,17.667z M63,17.667L89.418,17.667 89.418,30.778 63,30.778z M61,32.778L61,45.889 34.582,45.889 34.582,32.778z M63,32.778L89.418,32.778 89.418,45.889 63,45.889z M91.418,61L91.418,47.889 117.835,47.889 117.835,61z M117.835,63L117.835,76.111 91.418,76.111 91.418,63z M91.418,45.889L91.418,32.778 117.835,32.778 117.835,45.889z M89.418,47.889L89.418,61 63,61 63,47.889z M89.418,63L89.418,76.111 63,76.111 63,63z M91.418,78.111L117.835,78.111 117.835,91.223 91.418,91.223z M117.835,30.778L91.418,30.778 91.418,17.667 117.835,17.667z M32.582,17.667L32.582,30.778 6.165,30.778 6.165,17.667z M6.165,45.889L6.165,32.778 32.582,32.778 32.582,45.889z M34.582,47.889L61,47.889 61,61 34.582,61z M34.582,63L61,63 61,76.111 34.582,76.111z M32.582,78.111L32.582,91.223 6.165,91.223 6.165,78.111z M6.165,93.223L32.582,93.223 32.582,106.334 6.165,106.334z M91.418,106.334L91.418,93.223 117.835,93.223 117.835,106.334z" />
                                    </DrawingGroup>
                                </DrawingImage.Drawing>
                            </DrawingImage>
                        </Image.Source>
                    </Image>

                </RadioButton>
            </StackPanel>
        </Grid>

    </Grid>

</UserControl>